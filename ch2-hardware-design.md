#### 

#### 2.摄像头

#### 1.硬件布线

当初大学画电路板的时候，啥玩意都不懂，记得当初直接用面包板焊接，虽然好使，但其丑无比。后来工作也画过一些PCB，但是始终不得要领，以为能把线连上连对就万事大吉了。后来阅读了一些电子电路和硬件的书籍，有了自己的一点点体会，虽然不多，但是应付一般场合足够了。很简单的物理知识就可以理解，至于高手搞通信高频布线，要考虑群延时，分布电感电容，信号完整性分析，我觉得大家以后真的玩高级硬件的话，可以再深入，这里就算是一个简单入门吧。

这里我就先画一个非常简单的电路图，做一个简单的计算，大家就会明白。

比如一个电源给两个器件供电，一个工作电流10mA，一个工作电流10A，我们看下面图1中两种接线方式有啥区别？？？？？

![](/assets/EmbeddedSystem_S2_P1.png)

图1.两种接线方式理想电路图（红色为正，蓝色为负）

很多同学会说，不都是两个器件并联吗，不都是电源电压吗？？？电路原理的课上说啦，并联电压相等，所以上面的两张图，完全一个样子嘛，能有啥区别？？？！！！！

这里我要提醒大家啦，注意连线，那都是铜线，不是超导体，拿起小本子要记住啦，铜线也有阻抗，PCB布线也有阻抗。考虑进来，之后的图就是下面这样子图2所示。

![](/assets/EmbeddedSystem_S2_P2.png)

图2.考虑线路阻抗的等效电路图

有的同学看到图2，会说，才20m欧，能有啥大事嘛。。。。大家要记住，我们这里还没说电源电压多少V呢，如果是1000V的话，那当然没事，但是如果电源是7V电压呢？？？你想想两种布局方式，1A器件与10A器件的静态工作电压有什么差别？？

| 左侧布局 | 右侧布局 |
| :--- | :--- |
| **1A器件**电压：7-\(1+10\)\*\(0.02\*2\)=**6.56V** | **1A器件**电压：7-10\*0.02\*2-1\*0.02\*4=**6.52V** |
| **10A器件**电压：7-10\*0.02\*4-1\*0.02\*2=**6.16V** | **10A器件**电压：7-10\*0.02\*2-1\*0.02\*2=**6.56V** |

只通过一个简单的计算，我们就发现，右侧布局明显好于左侧布局，就因为10A电流在线路上产生了更大的线损，所以越靠近电源越好。这时候我们就得到这个结论，**功率越大的器件，越靠近电源供电的话，那对整个系统工作的影响就越小。**

于是我们的电路布局图就成为这个样子图3所示，大功率和小功率分布布局，大功率的地和电源尽可能从靠近电源的正负极直接引线，这样大功率器件对其他小功率器件的影响能够降到最小。

![](/assets/EmbeddedSystem_S2_P3.png)

图3.大功率与小功率分开布局

下面我的电路继续升级，加入了PWM数字开关器件，还有一些小的器件，大家有没有想过，这样玩，会不会有啥问题。。。

![](/assets/EmbeddedSystem_S2_P4.png)

图4.添加小器件和数字开关PWM部件

如果说第一条只用到了电路的欧姆定律，那这一条就要用到电磁感应原理，大家跟我的思路想哈，PWM要不停地开关，那0.5A电流就是交变的电流，交变的电流线圈会在整个线路环里产生交变的磁场，那是不是说所有包含在电源到0.5APWM器件的环路里的所有器件信号都会被这个交变磁场影响，因为交变的磁场会在其内部线路里又产生感性电动势和感应电流。这里只是0.5A，那如果10A电流也是开关器件呢，那简直瞬间干扰死那些线路里的小信号器件。于是我们就有了**第二条定律，大功率器件的电源和地最好贴着走，不要包含小功率的器件。**

于是图4就会进化到图5，虽然丑了点，是效果好呀！！！

![](/assets/EmbeddedSystem_S2_P5.png)

图5.电源和地贴着走布局图

所以最终结论就是如下：

* 尽可能大功率的器件靠近电源接线
* 尽可能开关功率器件尤其是大功率的开关器件，电源和地包络器件越少越好。

铭记上面两条法则，应该能应付一般的PCB布线了。

智能车电路为例，整体电路分为三部分，电机驱动，舵机，控制电路，布线如图6所示，三大部分彻底分开，尤其是电机驱动这块，流大电流。

![](/assets/EmbeddedSystem_S2_P0.png)图6.智能车PCB布线图

电机驱动阻抗分析：

B车电机内阻150m欧，电池内阻80m欧，电源线，保险和开关20-30m欧，PCB布线电阻20m欧，整体线路内阻大概是250-300m欧，如果按照电池工作电压7-8V计算的话，那短路电流有20-30A

C车模相对好一些，电机内阻900m欧，加上电池内阻，电源线，开关，保险丝，PCB布线100-150m欧，总阻抗1欧，即使考虑到双电机并联，最大电流不超过15A左右。

#### 2.电机H桥

聊完硬件布线，我们再聊聊直流电机，说简单点就是给它加直流电压，那它就转，比如图1的电路，一个开关K就可以控制电机转动和停止。

![](/assets/EmbeddedSystem_S2_P6.png)

图7.开关控制电机转和停

如果我们想让既能让电机正转，又能反转，那该怎么设计呢，如图8所示，为了简化，图中未画出续流二极管。K1和K2通的时候，电机正转，K3和K4通的时候，电机反转。

![](/assets/EmbeddedSystem_S2_P7.png)

图8.H桥正反转

H桥可以让电机工作于四个状态，如下表所示。

| 开关状态 | 电机状态 |
| :--- | :--- |
| K1和K2闭合 | 正转 |
| K3和K4闭合 | 反转 |
| K2和K4闭合 | 刹车状态 |
| 四个开关都断开 | 滑行状态 |



截至目前，电机的工作电压，要么是电池电压，要么电压为0，要么是反向电池电压，如果想调压调速的时候，那怎么办呢？？？搞电力电子的兄弟们发明了一种简单方法，比如现在电池只有7V电压，那可以这样玩，加个电子开关，给电机通电5ms7V，再断开5ms，然后依次循环，只要频率足够快就没啥事，这样等效下来是不是就相当于3.5V电压呀，然后通过调节开通关断时间比例，来连续调节电压，这就叫做PWM控制。简单点说，**有了PWM调节，我们的电机就可以调压调速了**。



具体玩法就是

